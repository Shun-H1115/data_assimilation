# アンサンブルカルマンフィルタにおける共分散膨張手法

## 1. 加法的共分散膨張（Additive Covariance Inflation）

### 背景

アンサンブルサイズが有限であるため、共分散が過小評価される傾向があります。これを補正するため、外部から追加的な不確実性を加える手法です。

### 方法と式

$$
\mathbf{P}^a_{	ext{inflated}} = \mathbf{P}^a + \mathbf{Q}
$$

- $$ \mathbf{P}^a $$ : 事後（分析）共分散行列
- $$ \mathbf{Q} $$ : モデル誤差や観測誤差に基づく外部的な共分散行列

### 特徴

- 明示的に不確実性を追加。
- 過剰な膨張がシステムを不安定化させる可能性。

---

## 2. 乗法的共分散膨張（Multiplicative Covariance Inflation）

### 背景

同様に過小評価を補正するため、共分散行列全体をスカラー係数でスケーリングします。

### 方法と式

$$
\mathbf{P}^a_{	ext{inflated}} = \lambda \mathbf{P}^a
$$

- $$ \mathbf{P}^a $$: 事後（分析）共分散行列
- $$ \lambda $$: スケールファクター ($$ \lambda > 1 $$ が膨張)

### 特徴

- 膨張の強度がシンプルに制御可能。
- 過大な膨張は非現実的な結果を招く。

---

## 3. 共分散緩和（Covariance Relaxation）

### 背景

事後共分散が観測データに過剰適合する問題を緩和するために、事後共分散と事前共分散の線形結合を行います。

### 方法と式

$$
\mathbf{P}^a_{	ext{relaxed}} = lpha \mathbf{P}^a + (1 - lpha) \mathbf{P}^f
$$

- $$ lpha \in [0, 1] $$: 緩和係数

### 特徴

- 過剰適合を抑制。
- 緩和係数 $$ lpha $$ の適切な選択が重要。

---

## 4. 動的共分散膨張（Dynamic Covariance Inflation）

### 背景

静的膨張では固定された膨張設定が適切でない場合があるため、膨張量や膨張係数を動的に変化させます。

### 方法と式

#### 動的加法的膨張

$$
\mathbf{P}^a_{	ext{inflated}, t} = \mathbf{P}^a_t + \mathbf{Q}_t
$$

#### 動的乗法的膨張

$$
\mathbf{P}^a_{	ext{inflated}, t} = \lambda_t \mathbf{P}^a_t
$$

$$
\lambda_t = 1 + \kappa rac{\sigma_{	ext{obs}}}{\sigma_{	ext{ens}}}
$$

- $$\sigma_{	ext{obs}}$$: 観測に基づく不確実性
- $$\sigma_{	ext{ens}}$$: アンサンブルによる不確実性

#### 自己診断に基づく動的調整

観測イノベーションや分散比に基づいて膨張を自己調整します。

---

## 比較表

| 手法                   | 特徴                                                         | 適用場面                         |
| ---------------------- | ------------------------------------------------------------ | -------------------------------- |
| 静的膨張（加法・乗法） | 定数の膨張パラメータを使用。シンプルで実装容易。             | 安定した観測条件下               |
| 動的膨張               | 膨張パラメータをシステム状態や観測条件に応じて動的に調整。   | 非線形系や観測条件が変動する場合 |
| 自己診断型動的膨張     | システムが観測イノベーションや分散比を基に膨張量を自己調整。 | 不確実性の診断が可能なシステム   |

---

## 適用例

- **気象モデル**: 観測ネットワークの不均一性や非線形大気現象の過小評価を補正。
- **海洋モデル**: 深海と表層で膨張強度を調整。
- **データ不足のシステム**: 観測データ量に応じた膨張の制御。
